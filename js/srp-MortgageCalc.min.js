function srp_check_prefilled(){jQuery('input[id$="price_of_home"]').each(function(){if(""!=jQuery(this).val()){var e=jQuery(this).attr("id"),r=e.replace(/\D/g,"");srp_MortgageCalc_calculate(r)}}),jQuery('input[id$="loan_amount"]').each(function(){if(""!=jQuery(this).val()){var e=jQuery(this).attr("id"),r=e.replace(/\D/g,"");srp_ClosingCosts_calculate(r)}})}function showClosingDetails(e){jQuery("#"+e).is(":hidden")?jQuery("#"+e).slideDown("slow"):jQuery("#"+e).slideUp("slow")}function srp_removeThickBoxEvents(){jQuery(".thickbox").each(function(){jQuery(this).unbind("click")})}function srp_bindThickBoxEvents(){srp_removeThickBoxEvents(),tb_init("a.thickbox, area.thickbox, input.thickbox")}function srp_MortgageCalc_calculate(e){jQuery("#srp_mortgagecalc-"+e+" div.additional-info").hide();var r=jQuery("input#widget-srp_mortgagecalc-"+e+"-price_of_home").asNumber(),t=jQuery("input#widget-srp_mortgagecalc-"+e+"-down_payment").asNumber(),i=jQuery("input#widget-srp_mortgagecalc-"+e+"-mortgage_term").asNumber(),s=jQuery("input#widget-srp_mortgagecalc-"+e+"-interest_rate").asNumber();if(100==t||t>100)return alert("Down Payment can not be equal of larger than the price of home."),jQuery("input#widget-srp_mortgagecalc-"+e+"-down_payment").val(""),srp_MortgageCalc_calculate(e),!1;if(jQuery("input#widget-srp_mortgagecalc-"+e+"-price_of_home").removeClass("highlight"),!r){jQuery("input#widget-srp_mortgagecalc-"+e+"-price_of_home").addClass("highlight");var a=!0}if(!i||0==i){jQuery("input#widget-srp_mortgagecalc-"+e+"-mortgage_term").addClass("highlight");var a=!0}if(!s||0==s){jQuery("input#widget-srp_mortgagecalc-"+e+"-interest_rate").addClass("highlight");var a=!0}if(a&&alert("Please fill out the highlighted fields."),!a){var o=s/100,l=Math.round(r*t/100*100)/100,n=o/12,c=12*i,u=Math.round(100*(r-l))/100,p=1+n,d=-1*c,_=1-Math.pow(p,d),g=Math.round(u*(n/_)*100)/100,m=0,y="",h=jQuery("input#property_tax_rate").asNumber(),f=jQuery("input#home_insurance_rate").asNumber(),v=jQuery("input#pmi").asNumber(),b=Math.round(r*h/100/12*100)/100,w=Math.round(r*f/100/12*100)/100;if(20>t)var j=Math.round(r*v/100/12*100)/100;else var j=0;m=b+w+j,y="<div>Principal & Interest:		"+srp_cl(g)+"</div><div>Mo. Tax:				"+srp_cl(b)+"</div><div>Mo. Home Insurance:	"+srp_cl(w)+"</div><div>Mo. PMI:				"+srp_cl(j)+"</div>";var Q="?form_complete=1&sale_price="+r+"&down_percent="+t+"&year_term="+i+"&annual_interest_percent="+s+"&show_progress=1",x="&height=500&width=650",N='<a href="'+srp.srp_inc+"/srp-AmmortResult.php"+Q+x+'" class="thickbox" title="Mortgage Amortization Schedule">Amortization Schedule</a>',M=y+"<div>Down Payment:		"+srp_cl(l)+"</div><div class='srp_tb srp_bb'>Financed Amount:	"+srp_cl(u)+"</div><div class='srp_result_link'>"+N+"</div>";jQuery("input#widget-srp_mortgagecalc-"+e+"-monthly_payment").val(Math.round(100*(g+m))/100).formatCurrency({symbol:""}),jQuery("input#widget-srp_mortgagecalc-"+e+"-monthly_payment").addClass("total"),jQuery("#widget-srp_mortgagecalc-"+e+"-result").html(M).slideDown("slow").show()}}function srp_Affordability_calculate(e){var r=jQuery("input#widget-srp_affordabilitycalc-"+e+"-mo_gross_income").asNumber(),t=jQuery("input#widget-srp_affordabilitycalc-"+e+"-mo_debt_expences").asNumber(),i=jQuery("input#widget-srp_affordabilitycalc-"+e+"-down_payment").asNumber(),s=jQuery("input#widget-srp_affordabilitycalc-"+e+"-interest_rate").asNumber(),a=jQuery("input#widget-srp_affordabilitycalc-"+e+"-property_tax").asNumber(),o=jQuery("input#widget-srp_affordabilitycalc-"+e+"-home_insurance").asNumber(),l=jQuery("input#widget-srp_affordabilitycalc-"+e+"-pmi").asNumber(),n=.28*r,c=.36*r-t;smaller=Math.round(c>n?n:c);var u=s/100/12,p=360,d=-p,_=Math.pow(1+u,d),g=u/(1-_),m=(o+a+l)/100/12,y=smaller/(g+m);i>0&&(y=(smaller-i*m)/(g+m));var h="Tax, insurance & PMI",f=100*i/(y+i);if(f>=20){l=0,m=(o+a+l)/100/12,y=Math.round((smaller-i*m)/(g+m)),f=100*i/(y+i);var h="Tax and insurance"}var v=Math.round(y+i),b=Math.round((o+a+l)*v/100/12),w="";if(i>0)var w='<div>Downpayment: <span class="srp_amnt">'+Math.round(100*f)/100+"%</span></div><div>Loan Amount: "+srp_cl(Math.round(y))+"</div>";var j="?type=affordability&mo_gross_income="+r+"&mo_debt_expences="+t+"&down_payment="+i+"&interest_rate="+s,Q="&height=700&width=600",x='<a href="'+srp.srp_inc+"/srp-AffordabilityResult.php"+j+Q+'" class="thickbox" title="Home Morgage Affordability">View Calculation Details</a>',N='<div class="srp_bb">You Should Afford: '+srp_cl(v)+"</div>"+w+"<div>Principal & Interest: "+srp_cl(smaller-b)+"</div><div>"+h+": "+srp_cl(b)+' </div><div class="srp_tb srp_bb">Total Payments (mo): '+srp_cl(smaller)+'</div><div class="srp_result_link">'+x+"</div>";r>0&&t>=0&&s>0&&jQuery("#widget-srp_affordabilitycalc-"+e+"-result").html(N).slideDown("slow").addClass("total")}function srp_ClosingCosts_calculate(e){var r=jQuery("input#widget-srp_closingcosts-"+e+"-loan_amount").asNumber(),t=jQuery("input#widget-srp_closingcosts-"+e+"-discount_points").asNumber(),i=jQuery("input#widget-srp_closingcosts-"+e+"-origination_fee").asNumber(),s=jQuery("input#widget-srp_closingcosts-"+e+"-lender_fees").asNumber(),a=jQuery("input#widget-srp_closingcosts-"+e+"-credit_report_fee").asNumber(),o=jQuery("input#widget-srp_closingcosts-"+e+"-appraisal").asNumber(),l=jQuery("input#widget-srp_closingcosts-"+e+"-title_insurance").asNumber(),n=jQuery("input#widget-srp_closingcosts-"+e+"-reconveyance_fee").asNumber(),c=jQuery("input#widget-srp_closingcosts-"+e+"-recording_fee").asNumber(),u=jQuery("input#widget-srp_closingcosts-"+e+"-wire_courier_fee").asNumber(),p=jQuery("input#widget-srp_closingcosts-"+e+"-endorsement_fee").asNumber(),d=jQuery("input#widget-srp_closingcosts-"+e+"-title_closing_fee").asNumber(),_=jQuery("input#widget-srp_closingcosts-"+e+"-title_doc_prep_fee").asNumber(),g=jQuery("input#widget-srp_closingcosts-"+e+"-other_fees").asNumber();if(t>0)var m=t/100*r;else var m=0;if(i>0)var y=i/100*r;else var y=0;var h=m+y+s+a+o+l+n+c+u+p+d+_+g,f="<strong>Total Closing Cost: "+srp_cl(h)+"</strong>";r>1e3&&h>0&&jQuery("#widget-srp_closingcosts-"+e+"-result").html(f).slideDown("slow").addClass("total")}function srp_cl(e){e+="",x=e.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var r=/(\d+)(\d{3})/;r.test(x1);)x1=x1.replace(r,"$1,$2");return'<span class="srp_amnt">$'+(x1+x2)+"</span>"}jQuery(document).ready(function(){jQuery(".srp-tabs").css({display:"block"}),jQuery('input[id^="widget-srp_mortgagecalc-"]').live("keyup",function(){var e=jQuery(this).attr("id"),r=e.replace(/\D/g,""),t=jQuery("input#widget-srp_mortgagecalc-"+r+"-price_of_home").asNumber();t>0&&srp_MortgageCalc_calculate(r)}),jQuery('input[id^="widget-srp_affordabilitycalc-"]').live("keyup",function(){var e=jQuery(this).attr("id"),r=e.replace(/\D/g,"");srp_Affordability_calculate(r)}),jQuery('input[id$="price_of_home"]').live("blur",function(){jQuery(this).formatCurrency({dropDecimals:!0,symbol:""})}),jQuery("a#srp_help").live("click",function(){jQuery("#srp_help_text > div.additional-info").css({background:"#F3F6FB",border:"1px solid #D2DFFF",padding:"5px"}).toggle("slow")}),jQuery('input[id^="widget-srp_closingcosts-"]').live("keyup",function(){var e=jQuery(this).attr("id"),r=e.replace(/\D/g,"");srp_ClosingCosts_calculate(r)}),srp_check_prefilled()});